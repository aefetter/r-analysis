"0","# step 1. make data quantifiable (ex. direct mentions = True, no direct mentions = False)"
"0","snl_topics_processed <- snl_topics %>%"
"0","  mutate(across("
"0","    contains(c(""reproductive"", ""immigration"", ""economics"", ""democracy"")),"
"0","    ~ case_when("
"0","        str_detect(., regex(""no (direct|mentions|statements)"", ignore_case = TRUE)) ~ FALSE,"
"0","        is.na(.) ~ NA,"
"0","        TRUE ~ TRUE"
"0","      ),"
"0","    .names = ""mentioned_{.col}"""
"0","  ))"
"0",""
"0","# Step 2: Reshape and clean for plotting"
"0","snl_topics_heatmap_data <- snl_topics_processed %>%"
"0","  select(show, date, starts_with(""mentioned_"")) %>%"
"0","  pivot_longer("
"0","    cols = starts_with(""mentioned_""),"
"0","    names_to = ""topic"","
"0","    values_to = ""mentioned"""
"0","  ) %>%"
"0","  mutate("
"0","    topic = str_replace(topic, ""mentioned_"", """"),  # Clean up topic names"
"0","    mentioned = ifelse(is.na(mentioned), FALSE, mentioned),  # Replace NA with FALSE"
"0","    candidate = ifelse(str_detect(topic, ""trump""), ""Trump"", ""Harris""),  # Add candidate column"
"0","    topic = str_replace(topic, ""_trump|_harris"", """"),  # Remove candidate suffix from topic names"
"0","    topic = str_to_title(topic),  # Capitalize topic names"
"0","    fill_group = case_when("
"0","      mentioned & candidate == ""Trump"" ~ ""Trump"",  # Trump mentions"
"0","      mentioned & candidate == ""Harris"" ~ ""Harris"",  # Harris mentions"
"0","      TRUE ~ ""None""  # No mentions"
"0","    ),"
"0","    # Label episodes with date for better timeline feel"
"0","    show_label = paste0(format(date, ""%b %d""), "" â€” "", show)"
"0","  )"
"0",""
"0","# Optional: custom topic order"
"0","topic_levels <- c(""Reproductive Rights"", ""Immigration"", ""Economics"", ""Democracy"")"
"0","snl_topics_heatmap_data$topic <- factor(snl_topics_heatmap_data$topic, levels = topic_levels)"
"0",""
"0","# Step 3: Plot"
"0","heatmap_vis <- ggplot(snl_topics_heatmap_data, aes(x = topic, y = fct_reorder(show_label, date), fill = fill_group)) +"
"0","  geom_tile(color = ""white"") +  # Add white borders around tiles"
"0","  scale_fill_manual("
"0","    values = c("
"0","      ""None"" = ""grey95"",  # Light grey for no mentions"
"0","      ""Trump"" = ""#D55E00"",  # Reddish for Trump mentions"
"0","      ""Harris"" = ""#0072B2""  # Blue for Harris mentions"
"0","    ),"
"0","    name = ""Mentioned By"","
"0","    labels = c(""None"" = ""Not Mentioned"", ""Trump"" = ""Trump"", ""Harris"" = ""Harris"")"
"0","  ) +"
"0","  labs("
"0","    title = ""SNL Episode Mentions by Topic and Candidate"","
"0","    subtitle = ""Cold Opens and Weekend Update Segments, Fall 2024"","
"0","    x = ""Policy Topic"","
"0","    y = ""Episode (Date + Title)"","
"0","    caption = ""Data source: SNL YouTube + Manual Coding | Created by Anna Fetter"""
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 45, hjust = 1, face = ""bold""),  # Rotate x-axis labels"
"0","    axis.text.y = element_text(size = 9),  # Adjust y-axis text size"
"0","    panel.grid = element_blank(),  # Remove grid lines"
"0","    plot.title = element_text(face = ""bold"", size = 16, hjust = 0.5),  # Center title"
"0","    plot.subtitle = element_text(size = 12, hjust = 0.5),  # Center subtitle"
"0","    plot.caption = element_text(size = 9, hjust = 0),  # Left-align caption"
"0","    legend.position = ""top"",  # Move legend to the top"
"0","    strip.text = element_text(face = ""bold"", size = 12)  # Bold facet labels"
"0","  )"
"0",""
"0","# Step 4: Print and save"
"0","print(heatmap_vis)"
