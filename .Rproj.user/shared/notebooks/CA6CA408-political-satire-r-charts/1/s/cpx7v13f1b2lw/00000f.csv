"0","library(patchwork)  # For combining plots"
"0",""
"0","# First, build labels like: 1 (Oct 01)"
"0","snl_heatmap_data <- snl_heatmap_data %>%"
"0","  arrange(date) %>%"
"0","  mutate("
"0","    ep_num = row_number(),"
"0","    ep_label = paste0(ep_num, "" ("", format(date, ""%b %d""), "")"")"
"0","  )"
"0",""
"0","# Pivot to long format for plotting"
"0","heatmap_long <- snl_heatmap_data %>%"
"0","  pivot_longer("
"0","    cols = c(economics, reproductive_rights, immigration, democracy),"
"0","    names_to = ""topic"","
"0","    values_to = ""mentioned_by"""
"0","  )"
"0",""
"0","# Color mapping"
"0","mention_colors <- c("
"0","  ""Trump"" = ""red"","
"0","  ""Harris"" = ""blue"","
"0","  ""Both"" = ""purple"","
"0","  ""None"" = ""grey90"""
"0",")"
"0",""
"0","# Build the heatmap"
"0","heatmap_plot <- ggplot(heatmap_long, aes(x = factor(ep_label, levels = unique(snl_heatmap_data$ep_label)), "
"0","                                         y = fct_rev(topic), fill = mentioned_by)) +"
"0","  geom_tile(color = ""white"", linewidth = 0.5) +"
"0","  scale_fill_manual(values = mention_colors, name = ""Mentioned By"") +"
"0","  labs("
"0","    title = ""SNL Mentions by Topic and Candidate"","
"0","    x = ""Episode Number (Air Date)"","
"0","    y = ""Topic"""
"0","  ) +"
"0","  theme_minimal(base_size = 14) +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 45, hjust = 1),"
"0","    panel.grid = element_blank()"
"0","  ) +"
"0","  geom_vline("
"0","    xintercept = which(snl_heatmap_data$date == as.Date(""2024-11-05"")),"
"0","    linetype = ""dashed"", color = ""black"""
"0","  )"
"0",""
"0","# Save the final version"
"0","ggsave(""snl_heatmap_final.png"", plot = heatmap_plot, width = 12, height = 6, dpi = 300)"
"0",""
