"0","# cleaning the data to capture total airtime for Trump & Harris"
"0",""
"0","# Function to calculate duration from timestamp ranges"
"0","calculate_duration <- function(time_range) {"
"0","  if (is.na(time_range) || time_range == ""none"" || time_range == """") return(0)"
"0","  "
"0","  # Process multiple ranges separated by ""and"""
"0","  ranges <- unlist(strsplit(time_range, "" and ""))"
"0","  total_seconds <- 0"
"0","  "
"0","  for (range in ranges) {"
"0","    # Split start and end times"
"0","    times <- unlist(strsplit(range, ""-""))"
"0","    if (length(times) != 2) next"
"0","    "
"0","    # Convert start time to seconds"
"0","    start_parts <- as.numeric(unlist(strsplit(times[1], "":"")))"
"0","    start_seconds <- if (length(start_parts) == 2) start_parts[1] * 60 + start_parts[2] else start_parts[1]"
"0","    "
"0","    # Convert end time to seconds"
"0","    end_parts <- as.numeric(unlist(strsplit(times[2], "":"")))"
"0","    end_seconds <- if (length(end_parts) == 2) end_parts[1] * 60 + end_parts[2] else end_parts[1]"
"0","    "
"0","    # Add duration to total"
"0","    total_seconds <- total_seconds + (end_seconds - start_seconds)"
"0","  }"
"0","  "
"0","  return(total_seconds)"
"0","}"
"0",""
"0","# Function to process timestamps into a dataframe of start and end times"
"0","process_timestamps <- function(timestamps, candidate) {"
"0","  if (is.na(timestamps) || timestamps == ""none"" || timestamps == """") {"
"0","    # Return an empty dataframe with the correct structure"
"0","    return(data.frame(start = numeric(0), end = numeric(0), candidate = character(0)))"
"0","  }"
"0","  "
"0","  # Split the timestamps by ""and"" to handle multiple ranges"
"0","  ranges <- unlist(strsplit(timestamps, "" and ""))"
"0","  segments <- data.frame()"
"0","  "
"0","  for (range in ranges) {"
"0","    # Split each range into start and end times"
"0","    times <- unlist(strsplit(range, ""-""))"
"0","    if (length(times) != 2) next"
"0","    "
"0","    # Convert start and end times to seconds"
"0","    start_parts <- as.numeric(unlist(strsplit(times[1], "":"")))"
"0","    start_seconds <- if (length(start_parts) == 2) start_parts[1] * 60 + start_parts[2] else start_parts[1]"
"0","    "
"0","    end_parts <- as.numeric(unlist(strsplit(times[2], "":"")))"
"0","    end_seconds <- if (length(end_parts) == 2) end_parts[1] * 60 + end_parts[2] else end_parts[1]"
"0","    "
"0","    # Add the segment to the dataframe"
"0","    segment <- data.frame("
"0","      start = start_seconds,"
"0","      end = end_seconds,"
"0","      candidate = candidate"
"0","    )"
"0","    segments <- rbind(segments, segment)"
"0","  }"
"0","  "
"0","  return(segments)"
"0","}"
