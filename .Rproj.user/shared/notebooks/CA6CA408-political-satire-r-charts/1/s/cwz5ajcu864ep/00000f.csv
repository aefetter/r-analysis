"0","# step 1. make data quantifiable (ex. direct mentions = True, no direct mentions = False)"
"0","snl_topics_processed <- snl_topics %>%"
"0","  mutate(across("
"0","    contains(c(""reproductive"", ""immigration"", ""economics"", ""democracy"")),"
"0","    ~ case_when("
"0","        str_detect(., regex(""no (direct|mentions|statements)"", ignore_case = TRUE)) ~ FALSE,"
"0","        is.na(.) ~ NA,"
"0","        TRUE ~ TRUE"
"0","      ),"
"0","    .names = ""mentioned_{.col}"""
"0","  ))"
"0",""
"0",""
"0","# step 2. "
"0","# Prepare the data for the heatmap"
"0","snl_topics_heatmap_data <- snl_topics_processed %>%"
"0","  select(show, date, starts_with(""mentioned_"")) %>%  # Select relevant columns"
"0","  pivot_longer("
"0","    cols = starts_with(""mentioned_""),  # Pivot all ""mentioned_"" columns"
"0","    names_to = ""topic"",                # Name for the new column containing topic names"
"0","    values_to = ""mentioned""            # Name for the new column containing TRUE/FALSE values"
"0","  ) %>%"
"0","  mutate("
"0","    topic = str_replace(topic, ""mentioned_"", """"),  # Clean up topic names"
"0","    mentioned = ifelse(is.na(mentioned), FALSE, mentioned)  # Replace NA with FALSE"
"0","  )"
"0",""
"0","# Create the heatmap"
"0","heatmap_vis <- ggplot(snl_topics_heatmap_data, aes(x = topic, y = fct_reorder(show, date), fill = mentioned)) +"
"0","  geom_tile(color = ""white"") +  # Add white borders around the tiles"
"0","  scale_fill_manual("
"0","    values = c(""FALSE"" = ""grey90"", ""TRUE"" = ""steelblue""),  # Colors for FALSE and TRUE"
"0","    name = ""Mentioned"""
"0","  ) +"
"0","  labs("
"0","    title = ""SNL Episode Mentions by Topic"","
"0","    x = ""Topic"","
"0","    y = ""Episode (Date/Title)"""
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 45, hjust = 1),  # Rotate topic labels for readability"
"0","    axis.text.y = element_text(size = 10),"
"0","    panel.grid = element_blank(),  # Remove grid lines"
"0","    plot.title = element_text(face = ""bold"", size = 16, hjust = 0.5)"
"0","  )"
"0",""
"0","# Print the heatmap"
"0","print(heatmap_vis)"
